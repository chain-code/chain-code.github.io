<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="亲测有效 # 【摘要】 之前介绍了使用官方脚本自动化启动一个Fabric网络，并且所有的证书都是通过官方的命令行工具cryptogen直接生成网络中的所有节点的证书。在开发环境可以这么简单进行，但是生成环境下还是需要我们自定义对网络中的节点的证书进行配置。所以在本文中，将会详细介绍一个从手动生成证书一直到启动网络的整体步骤。本文只交代整体的搭建步骤。对于Fabric-Ca的讲解不在本文的范围内。
之前介绍了使用官方脚本自动化启动一个Fabric网络，并且所有的证书都是通过官方的命令行工具cryptogen直接生成网络中的所有节点的证书。在开发环境可以这么简单进行，但是生成环境下还是需要我们自定义对网络中的节点的证书进行配置。 所以在本文中，将会详细介绍一个从手动生成证书一直到启动网络的整体步骤。本文只交代整体的搭建步骤。对于Fabric-Ca的讲解不在本文的范围内，将在另一篇文章中说明。 在这里贴出官方文档地址.
1.整体架构 # 架构图直接贴过来好了： 官方文档采用的是多机环境，这里简洁化一点，所有的操作都在一台机器上进行，至于多机环境，以后再补充好了。 介绍一下本文所采用的整体架构：
三个组织 Org0 -&gt; 组织0 Org1 -&gt; 组织1 Org2 -&gt; 组织2 组织中的成员 Org0 一个Orderer节点，一个Org0的Admin节点 Org1 两个Peer节点，一个Org1的Admin节点，一个Org1的User节点 Org2 两个Peer节点，一个Org2的Admin节点，一个Org2的User节点 共有四台CA服务器 TLS服务器 -&gt; 为网络中所有节点颁发TLS证书，用于通信的加密 Org1的CA服务器 -&gt; 为组织1中所有用户颁发证书 Org2的Ca服务器 -&gt; 为组织2中所有用户颁发证书 Org0的CA服务器 -&gt; 为组织0中所有用户颁发证书 这里的四台CA服务器都是根服务器。彼此之间都是独立的存在，没有任何关系。，也就是说每一个CA服务器生成的证书在其他CA服务器都是不能用的。 介绍完之后，可以进入正题了。
1.1Fabric，Fabric-Ca安装 # 本文默认读者都是对Fabric有一定的了解的，所以一些安装过程这里就没有重复说明。 第一步是安装Fabric-Ca环境，可以参考这里,这篇文章还没有写完，以后慢慢补，不过环境的安装已经有说明。 还有就是Fabric的环境安装，可以参考这里。
完成环境搭建后，我们还需要一个HOME文件夹，用于存放我们生成的证书文件与fabric配置相关的文件。 本文设置HOME文件夹路径为:
$GOPATH/src/github.com/caDemo/ 请读者自行创建，一般不要用太复杂的路径,也不要用中文路径，会为之后的操作带来很多麻烦。在下文中简单称HOME文件夹为工作目录,除非特殊说明，一般命令的执行都是在工作目录进行。
2 CA服务器配置 # 2.1启动TLS CA服务器 # 前期工作准备好之后，我们开始启动第一台CA服务器。本文中使用Docker容器启动。 首先在工作目录创建docker-compose.yaml文件：
touch docker-compose.yaml 并在文件内添加以下内容(tips:内容格式不要乱掉)：
version: &#39;2&#39; networks: fabric-ca: services: ca-tls: container_name: ca-tls image: hyperledger/fabric-ca command: sh -c &#39;fabric-ca-server start -d -b tls-ca-admin:tls-ca-adminpw --port 7052&#39; environment: - FABRIC_CA_SERVER_HOME=/ca/tls - FABRIC_CA_SERVER_TLS_ENABLED=true - FABRIC_CA_SERVER_CSR_CN=ca-tls - FABRIC_CA_SERVER_CSR_HOSTS=0.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="手动生成ca证书搭建fabric网络" />
<meta property="og:description" content="亲测有效 # 【摘要】 之前介绍了使用官方脚本自动化启动一个Fabric网络，并且所有的证书都是通过官方的命令行工具cryptogen直接生成网络中的所有节点的证书。在开发环境可以这么简单进行，但是生成环境下还是需要我们自定义对网络中的节点的证书进行配置。所以在本文中，将会详细介绍一个从手动生成证书一直到启动网络的整体步骤。本文只交代整体的搭建步骤。对于Fabric-Ca的讲解不在本文的范围内。
之前介绍了使用官方脚本自动化启动一个Fabric网络，并且所有的证书都是通过官方的命令行工具cryptogen直接生成网络中的所有节点的证书。在开发环境可以这么简单进行，但是生成环境下还是需要我们自定义对网络中的节点的证书进行配置。 所以在本文中，将会详细介绍一个从手动生成证书一直到启动网络的整体步骤。本文只交代整体的搭建步骤。对于Fabric-Ca的讲解不在本文的范围内，将在另一篇文章中说明。 在这里贴出官方文档地址.
1.整体架构 # 架构图直接贴过来好了： 官方文档采用的是多机环境，这里简洁化一点，所有的操作都在一台机器上进行，至于多机环境，以后再补充好了。 介绍一下本文所采用的整体架构：
三个组织 Org0 -&gt; 组织0 Org1 -&gt; 组织1 Org2 -&gt; 组织2 组织中的成员 Org0 一个Orderer节点，一个Org0的Admin节点 Org1 两个Peer节点，一个Org1的Admin节点，一个Org1的User节点 Org2 两个Peer节点，一个Org2的Admin节点，一个Org2的User节点 共有四台CA服务器 TLS服务器 -&gt; 为网络中所有节点颁发TLS证书，用于通信的加密 Org1的CA服务器 -&gt; 为组织1中所有用户颁发证书 Org2的Ca服务器 -&gt; 为组织2中所有用户颁发证书 Org0的CA服务器 -&gt; 为组织0中所有用户颁发证书 这里的四台CA服务器都是根服务器。彼此之间都是独立的存在，没有任何关系。，也就是说每一个CA服务器生成的证书在其他CA服务器都是不能用的。 介绍完之后，可以进入正题了。
1.1Fabric，Fabric-Ca安装 # 本文默认读者都是对Fabric有一定的了解的，所以一些安装过程这里就没有重复说明。 第一步是安装Fabric-Ca环境，可以参考这里,这篇文章还没有写完，以后慢慢补，不过环境的安装已经有说明。 还有就是Fabric的环境安装，可以参考这里。
完成环境搭建后，我们还需要一个HOME文件夹，用于存放我们生成的证书文件与fabric配置相关的文件。 本文设置HOME文件夹路径为:
$GOPATH/src/github.com/caDemo/ 请读者自行创建，一般不要用太复杂的路径,也不要用中文路径，会为之后的操作带来很多麻烦。在下文中简单称HOME文件夹为工作目录,除非特殊说明，一般命令的执行都是在工作目录进行。
2 CA服务器配置 # 2.1启动TLS CA服务器 # 前期工作准备好之后，我们开始启动第一台CA服务器。本文中使用Docker容器启动。 首先在工作目录创建docker-compose.yaml文件：
touch docker-compose.yaml 并在文件内添加以下内容(tips:内容格式不要乱掉)：
version: &#39;2&#39; networks: fabric-ca: services: ca-tls: container_name: ca-tls image: hyperledger/fabric-ca command: sh -c &#39;fabric-ca-server start -d -b tls-ca-admin:tls-ca-adminpw --port 7052&#39; environment: - FABRIC_CA_SERVER_HOME=/ca/tls - FABRIC_CA_SERVER_TLS_ENABLED=true - FABRIC_CA_SERVER_CSR_CN=ca-tls - FABRIC_CA_SERVER_CSR_HOSTS=0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chain-code.github.io/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E7%8E%AF%E5%A2%83%E6%B5%8B%E8%AF%95/2021-05-01-%E6%89%8B%E5%8A%A8%E7%94%9F%E6%88%90ca%E8%AF%81%E4%B9%A6%E6%90%AD%E5%BB%BAfabric%E7%BD%91%E7%BB%9C/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2021-05-01T17:16:17+00:00" />
<meta property="article:modified_time" content="2021-05-01T17:16:17+00:00" />
<title>手动生成ca证书搭建fabric网络 | Soulmate</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" >
<link rel="stylesheet" href="/book.min.f8de3645fe00591b41524aee174e19edd98a22255a2930a0cdc82a94835ba387.css" integrity="sha256-&#43;N42Rf4AWRtBUkruF04Z7dmKIiVaKTCgzcgqlINbo4c=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.f057020be292ad545abe80c4fa07eb1c1bdb9cfeb4d47bed332c55eb99cedf51.js" integrity="sha256-8FcCC&#43;KSrVRavoDE&#43;gfrHBvbnP601HvtMyxV65nO31E=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.png" alt="Logo" /><span>Soulmate</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>计算机基础</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1e99d92668627838818961f696faae00" class="toggle"  />
    <label for="section-1e99d92668627838818961f696faae00" class="flex justify-between">
      <a role="button" class="">八股文</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%AB%E8%82%A1%E6%96%87/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/" class="">操作系统基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%AB%E8%82%A1%E6%96%87/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80-%E7%89%9B%E5%AE%A2/" class="">数据库基础-牛客</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%AB%E8%82%A1%E6%96%87/%E7%89%9B%E5%AE%A2%E5%85%AB%E8%82%A1/" class="">牛客八股</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%AB%E8%82%A1%E6%96%87/%E9%9D%A2%E8%A7%86%E9%A2%98%E6%80%BB%E7%BB%93%E4%B8%80/" class="">面视题总结（一）</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%AB%E8%82%A1%E6%96%87/%E9%9D%A2%E8%A7%86%E9%A2%98%E6%80%BB%E7%BB%93%E4%BA%8C/" class="">面视题总结（二）</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%AB%E8%82%A1%E6%96%87/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" class="">计算机网络基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%AB%E8%82%A1%E6%96%87/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/" class="">数据库基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%AB%E8%82%A1%E6%96%87/%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8/" class="">布隆过滤器</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%AB%E8%82%A1%E6%96%87/%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/" class="">算法基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%AB%E8%82%A1%E6%96%87/linux%E5%9F%BA%E7%A1%80/" class="">Linux基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%AB%E8%82%A1%E6%96%87/git%E5%9F%BA%E7%A1%80/" class="">Git基础</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-00c75bd1eabdaaae0cac73d13168e71f" class="toggle"  />
    <label for="section-00c75bd1eabdaaae0cac73d13168e71f" class="flex justify-between">
      <a role="button" class="">其他</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/crontab%E4%BD%BF%E7%94%A8/" class="">crontab使用</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/libewf%E5%BA%93%E7%BC%96%E8%AF%91/" class="">libewf库编译</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/localhost%E4%B8%8E127.0.0.1/" class="">localhost与127.0.0.1</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/schtasks%E4%BD%BF%E7%94%A8/" class="">schtask使用</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/swagger/" class="">Swagger</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/vim%E7%BC%96%E7%A8%8B%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/" class="">Vim编程常用快捷键</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93/" class="">代码整洁之道</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/%E4%BB%A3%E7%A0%81%E6%B3%A8%E9%87%8A/" class="">代码注释</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/%E5%90%8C%E6%97%B6%E4%BD%BF%E7%94%A8github%E5%92%8Cgitlab/" class="">同时使用github和gitlab</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/%E8%8E%B7%E5%8F%96%E5%86%85%E7%BD%91%E6%B4%BB%E8%B7%83ip/" class="">获取内网活跃IP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/%E9%80%9A%E8%BF%87%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81%E8%AE%A1%E7%AE%97ip%E5%9C%B0%E5%9D%80%E8%8C%83%E5%9B%B4/" class="">通过子网掩码计算IP地址范围</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/%E9%85%8D%E7%BD%AEkylinv10/" class="">配置 Kylin V10</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%85%B6%E4%BB%96/%E8%99%9A%E6%8B%9F%E7%BB%84%E7%BD%91/" class="">虚拟组网</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3dcacc5e7a7c646c608757dc5f042d92" class="toggle"  />
    <label for="section-3dcacc5e7a7c646c608757dc5f042d92" class="flex justify-between">
      <a role="button" class="">LeetCode</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/leetcode/2021-10-14-golang%E5%8A%9B%E6%89%A3%E5%88%B7%E9%A2%98%E4%B8%80/" class="">golang力扣刷题（一）</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/leetcode/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E4%B8%80/" class="">每日一题（一）</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/leetcode/2021-11-04-golang%E5%8A%9B%E6%89%A3%E5%88%B7%E9%A2%98%E4%BA%8C/" class="">golang力扣刷题（二）</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/leetcode/%E5%BF%85%E5%88%B7top101/" class="">必刷top101</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/leetcode/2021-10-28-leetcode%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/" class="">LeetCode算法总结</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Golang</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-670eda717a06f31447c52422ec93a159" class="toggle"  />
    <label for="section-670eda717a06f31447c52422ec93a159" class="flex justify-between">
      <a role="button" class="">基础</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/2021-04-07-go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E4%B8%80/" class="">go语言基础（一）</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/channel/" class="">Channel</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/go-%E4%B8%AD%E4%BD%BF%E7%94%A8-sync.pool-%E6%97%B6%E5%8F%AF%E8%83%BD%E9%81%87%E5%88%B0%E7%9A%84%E9%99%B7%E9%98%B1/" class="">Go 中使用 sync.Pool 时可能遇到的陷阱</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/golangci-lint/" class="">golangci-lint</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/golang%E6%8E%A7%E6%B5%81/" class="">Golang控流</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/golang%E9%99%90%E6%B5%81%E5%AE%9E%E8%B7%B5/" class="">golang限流实践</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/go%E6%B3%9B%E5%9E%8B%E4%BB%8B%E7%BB%8D/" class="">go泛型介绍</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/panic/" class="">panic</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/pprof/" class="">pprof</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/protobuf/" class="">ProtoBuf</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/url/" class="">URL</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/%E5%8C%85%E7%AE%A1%E7%90%86/" class="">包管理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" class="">单元测试</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/io.copy/" class="">奇怪的io.copy</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/%E5%B8%B8%E7%94%A8%E4%B8%9A%E5%8A%A1%E4%BB%A3%E7%A0%81/" class="">常用业务代码</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/2021-10-26-go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E4%BA%8C/" class="">go语言基础（二）</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E4%B8%89/" class="">go语言基础（三）</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-go/" class="">数据结构-go</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/go%E8%AF%AD%E8%A8%80%E5%BA%95%E5%B1%82%E5%9F%BA%E7%A1%80/" class="">go语言底层基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/2021-12-20-benchmark%E6%B5%8B%E8%AF%95/" class="">benchmark测试</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/go%E5%AE%89%E5%85%A8%E6%8C%87%E5%8D%97/" class="">Go安全指南</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/json%E5%BA%8F%E5%88%97%E5%8C%96/" class="">Json序列化</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/%E4%BD%BF%E7%94%A8ollvm%E6%B7%B7%E6%B7%86hello-world/" class="">使用 Ollvm混淆 Hello World</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB%E5%90%88%E9%9B%86/" class="">经验分享合集</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E5%9F%BA%E7%A1%80/goland%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7/" class="">Goland常用技巧</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c453881a62c640f6a4cceec99c02477e" class="toggle"  />
    <label for="section-c453881a62c640f6a4cceec99c02477e" class="flex justify-between">
      <a role="button" class="">高阶</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E9%AB%98%E9%98%B6/go%E9%AB%98%E9%98%B6-%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/" class="">Go高阶-语言基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E9%AB%98%E9%98%B6/go%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/" class="">Go内存对齐</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E9%AB%98%E9%98%B6/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" class="">并发编程</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E9%AB%98%E9%98%B6/go%E9%81%BF%E5%9D%91%E6%8C%87%E5%8D%97/" class="">Go避坑指南</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E9%AB%98%E9%98%B6/go%E9%AB%98%E9%98%B6-%E8%AF%AD%E8%A8%80%E7%B1%BB%E5%BA%93/" class="">Go高阶 语言类库</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E9%AB%98%E9%98%B6/go%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="">go性能优化</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E9%AB%98%E9%98%B6/go%E9%AB%98%E9%98%B6-%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7/" class="">Go高阶 高级特性</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E9%AB%98%E9%98%B6/%E6%98%93%E9%94%99%E7%BB%86%E8%8A%82/" class="">易错细节</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f235e88e751d2cb18d527c1784763605" class="toggle"  />
    <label for="section-f235e88e751d2cb18d527c1784763605" class="flex justify-between">
      <a role="button" class="">Package</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/package/flag/" class="">Flag</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/package/atomic/" class="">Atomic</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/package/os/" class="">Os</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/package/strconv/" class="">Strconv</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/package/sort/" class="">Sort</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/package/strings/" class="">Strings</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/package/reflect/" class="">Reflect</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/package/context/" class="">context</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/package/filepath/" class="">filepath</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/package/math/" class="">math</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/package/time/" class="">Time</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/package/sync/" class="">Sync</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-98f45c00d30ea45270982f872bd1c0bb" class="toggle"  />
    <label for="section-98f45c00d30ea45270982f872bd1c0bb" class="flex justify-between">
      <a role="button" class="">第三方库</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/resty/" class="">resty</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/diskqueue/" class="">diskqueue</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/golang/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/gofpdf/" class="">gofpdf</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>AI</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9b671b3ce1ddd28af1b4312866c8b524" class="toggle"  />
    <label for="section-9b671b3ce1ddd28af1b4312866c8b524" class="flex justify-between">
      <a role="button" class="">Basic</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/basic/cursor%E7%BB%AD%E6%9D%AF/" class="">cursor续杯</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/basic/mcp%E6%9C%8D%E5%8A%A1/" class="">MCP服务</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/basic/opencv_cuda%E7%BC%96%E8%AF%91/" class="">Opencv Cuda编译</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/basic/pytorch%E9%A3%9F%E8%B0%B1/" class="">pytorch食谱</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/basic/trae%E4%BD%BF%E7%94%A8%E5%BF%83%E5%BE%97%E5%88%86%E4%BA%AB/" class="">Trae使用心得分享</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/basic/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="">基础知识</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/basic/%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7%E5%BA%93/" class="">相关工具库</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/basic/%E9%A1%B9%E7%9B%AE%E6%94%B6%E8%97%8F/" class="">项目收藏</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/basic/ai%E7%9F%A5%E8%AF%86%E6%99%AE%E5%8F%8A/" class="">Ai知识普及</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-12d52a883bb94360d36ad3bbf0cb5fd3" class="toggle"  />
    <label for="section-12d52a883bb94360d36ad3bbf0cb5fd3" class="flex justify-between">
      <a role="button" class="">Computer Vision</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/computer-vision/ocr%E8%AF%86%E5%88%AB/" class="">Ocr识别</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/computer-vision/reid%E6%95%B0%E6%8D%AE%E9%9B%86/" class="">Reid数据集</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/computer-vision/reid%E8%A1%8C%E4%BA%BA%E9%87%8D%E8%AF%86%E5%88%AB/" class="">Reid行人重识别</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/computer-vision/yolo-world/" class="">yolo-world</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/computer-vision/yolo%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/" class="">yolo底层原理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/computer-vision/yolo%E6%95%B0%E6%8D%AE%E9%9B%86/" class="">yolo数据集</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/computer-vision/%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA%E4%BB%8B%E7%BB%8D/" class="">图像增强介绍</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/computer-vision/%E5%9B%BE%E5%83%8F%E8%B6%85%E5%88%86%E5%8E%9F%E7%90%86/" class="">图像超分原理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/computer-vision/%E8%A7%86%E9%A2%91%E8%B6%85%E5%88%86/" class="">视频超分</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/computer-vision/yolov8%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B&#43;%E5%AE%9E%E8%B7%B5/" class="">Yolov8快速上手 实践</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-948cfe1684759289af9e39747f026a40" class="toggle"  />
    <label for="section-948cfe1684759289af9e39747f026a40" class="flex justify-between">
      <a role="button" class="">Generative AI</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/generative-ai/qwen2.5-vl%E6%BA%90%E7%A0%81%E9%83%A8%E7%BD%B2/" class="">Qwen2.5-vl源码部署</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/generative-ai/xinference%E5%9F%BA%E7%A1%80/" class="">Xinference基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ai/generative-ai/%E5%88%A9%E7%94%A8dspy%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90prompt/" class="">利用 Dspy自动生成 Prompt</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-ac8e4e2fda641053d78fc10cbbde236e" class="toggle"  />
    <label for="section-ac8e4e2fda641053d78fc10cbbde236e" class="flex justify-between">
      <a role="button" class="">C</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/c/c&#43;&#43;%E9%83%A8%E7%BD%B2paddleocr/" class="">C&#43;&#43;部署PaddleOCR</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/c/cgo/" class="">CGo</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/c/cgo%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/" class="">CGO遇到的问题解决</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/c/%E4%B8%9A%E5%8A%A1%E4%BB%A3%E7%A0%81/" class="">业务代码</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/c/%E5%9C%A8cgo%E4%B8%AD%E9%9B%86%E6%88%90%E5%92%8C%E8%B0%83%E7%94%A8dll%E6%96%87%E4%BB%B6/" class="">在CGO中集成和调用DLL文件</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Python</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9fa9875ee3af29ba8922d532968a7155" class="toggle"  />
    <label for="section-9fa9875ee3af29ba8922d532968a7155" class="flex justify-between">
      <a role="button" class="">基础</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/python/%E5%9F%BA%E7%A1%80/python%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E6%8E%92%E6%9F%A5%E6%96%B9%E6%B3%95/" class="">python内存泄漏排查方法</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/python/%E5%9F%BA%E7%A1%80/python%E5%9F%BA%E7%A1%80/" class="">python基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/python/%E5%9F%BA%E7%A1%80/python%E5%AE%89%E8%A3%85/" class="">python安装</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/python/%E5%9F%BA%E7%A1%80/venv%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/" class="">venv虚拟环境</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/python/%E5%9F%BA%E7%A1%80/%E5%BC%80%E5%8F%91%E5%AE%9E%E4%BE%8B/" class="">开发实例</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/python/%E5%9F%BA%E7%A1%80/%E6%97%A5%E5%B8%B8%E5%B0%8F%E8%84%9A%E6%9C%AC/" class="">日常小脚本</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-76d10924673a9347dff74c68c3ea9d86" class="toggle"  />
    <label for="section-76d10924673a9347dff74c68c3ea9d86" class="flex justify-between">
      <a role="button" class="">Package</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/python/package/argparse/" class="">argparse</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/python/package/collections/" class="">collections</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/python/package/detetime/" class="">datetime</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/python/package/decord/" class="">Decord</a>
  

        </li>
      
    
      
    
      
        <li>
          
  
  

  
    <a href="/docs/python/package/uvicorn/" class="">uvicorn</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/python/package/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="">正则表达式</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>数据库</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-94f26238d1ca3b5bcd40eadc7a88d726" class="toggle"  />
    <label for="section-94f26238d1ca3b5bcd40eadc7a88d726" class="flex justify-between">
      <a role="button" class="">MySql</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/" class="">MySql相关问题</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E9%94%81%E7%9B%B8%E5%85%B3%E6%80%BB%E7%BB%93/" class="">MySql锁相关总结</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/2021-04-20-mysql%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/" class="">MySql基础总结</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mac%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E6%89%80%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/" class="">Mac连接数据库所遇到的问题</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/" class="">数据库设计</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-01e4ef5e6295826a1eab8f1a7114ec2c" class="toggle"  />
    <label for="section-01e4ef5e6295826a1eab8f1a7114ec2c" class="flex justify-between">
      <a role="button" class="">Redis</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/2022-03-21-redis%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/" class="">Redis集群搭建</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/2022-03-20-redis%E5%9F%BA%E7%A1%80/" class="">Redis基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/2021-05-02-redis%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/" class="">redis面试总结</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-8be9c2251abd1fe110e3c1520cac6177" class="toggle"  />
    <label for="section-8be9c2251abd1fe110e3c1520cac6177" class="flex justify-between">
      <a role="button" class="">SQLite</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/sqlite/fts/" class="">fts</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/sqlite/sqlite/" class="">Sqlite</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/sqlite/sqlite%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%92%E5%85%A5%E4%BC%98%E5%8C%96/" class="">Sqlite数据库插入优化</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f65a9544b5a0dd9c3cbedb29b743305e" class="toggle"  />
    <label for="section-f65a9544b5a0dd9c3cbedb29b743305e" class="flex justify-between">
      <a role="button" class="">基础</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%9F%BA%E7%A1%80/mongodb%E5%AE%89%E8%A3%85/" class="">Mongodb安装</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A7%84%E8%8C%83%E5%8C%96/" class="">数据库规范化</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%9F%BA%E7%A1%80/xorm/" class="">Xorm</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%9F%BA%E7%A1%80/gorm/" class="">Gorm</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%9F%BA%E7%A1%80/%E5%B8%B8%E8%A7%81%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/" class="">常见数据库的备份与恢复</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>系统架构</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E5%9F%BA%E7%A1%80/" class="">系统架构基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-083ca86fd1b56cca1f76a6d6b34dc093" class="toggle"  />
    <label for="section-083ca86fd1b56cca1f76a6d6b34dc093" class="flex justify-between">
      <a role="button" class="">设计模式</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="">创建型设计模式</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="">结构型设计模式</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="">行为型设计模式</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%89%A9%E5%B1%95/" class="">设计模式扩展</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-266e66094f86ce336245af3b8aaf0e2e" class="toggle"  />
    <label for="section-266e66094f86ce336245af3b8aaf0e2e" class="flex justify-between">
      <a role="button" class="">微服务</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/%E5%BE%AE%E6%9C%8D%E5%8A%A1/grpc/" class="">Grpc</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/%E5%BE%AE%E6%9C%8D%E5%8A%A1/grpc%E6%8B%A6%E6%88%AA%E5%99%A8retry/" class="">grpc拦截器retry</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" class="">微服务</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3d14fec58473cc9c35cafaca50699647" class="toggle"  />
    <label for="section-3d14fec58473cc9c35cafaca50699647" class="flex justify-between">
      <a role="button" class="">web框架</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/web%E6%A1%86%E6%9E%B6/gin%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9A/" class="">Gin参数绑定</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/web%E6%A1%86%E6%9E%B6/%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E4%B8%8E%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1/" class="">动态路由与静态路由</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/web%E6%A1%86%E6%9E%B6/gin%E6%A1%86%E6%9E%B6/" class="">gin框架</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/web%E6%A1%86%E6%9E%B6/%E6%B5%81%E5%BC%8F%E6%95%B0%E6%8D%AE/" class="">流式数据</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/web%E6%A1%86%E6%9E%B6/beego%E6%A1%86%E6%9E%B6/" class="">Beego框架</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-a4047feef6f367d46b68d1e8995f5851" class="toggle"  />
    <label for="section-a4047feef6f367d46b68d1e8995f5851" class="flex justify-between">
      <a role="button" class="">前端</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%89%8D%E7%AB%AF/restfulapi/" class="">Restful API</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%89%8D%E7%AB%AF/vite&#43;vue%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E9%A1%B9%E7%9B%AE/" class="">Vite&#43;Vue快速搭建项目</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%89%8D%E7%AB%AF/vue3/" class="">Vue3</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%89%8D%E7%AB%AF/vue%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="">Vue环境搭建</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%89%8D%E7%AB%AF/websocket/" class="">Web Socket</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%89%8D%E7%AB%AF/webstorm-debug/" class="">WebStorm-debug</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-5ee6dbeeb93d5d07b824c3368271f046" class="toggle" checked />
    <label for="section-5ee6dbeeb93d5d07b824c3368271f046" class="flex justify-between">
      <a role="button" class="">区块链</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-76bfb65f46ce25a0ff78d6cc4ad47773" class="toggle" checked />
    <label for="section-76bfb65f46ce25a0ff78d6cc4ad47773" class="flex justify-between">
      <a role="button" class="">Fabric</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/2022-02-25-fabric%E7%9B%B8%E5%85%B3%E6%9C%BA%E5%88%B6%E4%B8%8E%E5%8E%9F%E7%90%86/" class="">fabric相关机制与原理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/2021-05-10-%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/" class="">智能合约</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/2021-05-08-fabric-sdk-go%E8%AF%A6%E8%A7%A3/" class="">fabric-sdk-go详解</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/2021-04-15-fabric-ca%E8%AF%A6%E8%A7%A3/" class="">fabric-ca详解</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1e3df3eda5cf08a9c7e8cc723288fefb" class="toggle" checked />
    <label for="section-1e3df3eda5cf08a9c7e8cc723288fefb" class="flex justify-between">
      <a role="button" class="">环境测试</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E7%8E%AF%E5%A2%83%E6%B5%8B%E8%AF%95/fabric%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E6%8A%A5%E9%94%99%E4%B8%80/" class="">fabric网络中的报错（一）</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E7%8E%AF%E5%A2%83%E6%B5%8B%E8%AF%95/2021-03-22-fabric%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E6%8A%A5%E9%94%99%E4%BA%8C/" class="">fabric网络中的报错（二）</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E7%8E%AF%E5%A2%83%E6%B5%8B%E8%AF%95/2021-03-24-fabric%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="">fabric环境搭建</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E7%8E%AF%E5%A2%83%E6%B5%8B%E8%AF%95/2021-03-25-fabric-solo%E8%8A%82%E7%82%B9%E6%B5%8B%E8%AF%95/" class="">solo节点测试</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E7%8E%AF%E5%A2%83%E6%B5%8B%E8%AF%95/2021-03-25-fabric%E5%A4%9A%E6%9C%BA%E6%90%AD%E5%BB%BA/" class="">fabric多机搭建</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E7%8E%AF%E5%A2%83%E6%B5%8B%E8%AF%95/2021-12-20-%E9%83%A8%E7%BD%B2tape%E6%B5%8B%E8%AF%95/" class="">部署tape测试</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E7%8E%AF%E5%A2%83%E6%B5%8B%E8%AF%95/2021-05-01-%E6%89%8B%E5%8A%A8%E7%94%9F%E6%88%90ca%E8%AF%81%E4%B9%A6%E6%90%AD%E5%BB%BAfabric%E7%BD%91%E7%BB%9C/" class="active">手动生成ca证书搭建fabric网络</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E7%8E%AF%E5%A2%83%E6%B5%8B%E8%AF%95/2021-03-18-centos%E5%AE%89%E8%A3%85fabric1.2/" class="">centos安装fabric1.2</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-25aef1d59a561fcefcaecb043ef8afd2" class="toggle"  />
    <label for="section-25aef1d59a561fcefcaecb043ef8afd2" class="flex justify-between">
      <a role="button" class="">配置文件</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/2021-05-01-cryptogen%E7%94%9F%E6%88%90%E7%9A%84%E8%AF%81%E4%B9%A6%E8%AF%A6%E8%A7%A3/" class="">cryptogen生成的证书详解</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/2021-03-30-config-yaml%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/" class="">config.yaml文件详解</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/2021-03-30-docker-compose-yaml%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/" class="">docker-compose.yaml文件详解</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/2021-03-29-configtx-yaml%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/" class="">configtx.yaml文件详解</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/2021-03-29-crypto-config-yaml%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/" class="">crypto-config.yaml文件详解</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/2022-04-14-%E5%8D%87%E7%BA%A7%E9%93%BE%E7%A0%81/" class="">升级链码</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/2022-03-25-%E5%8C%BA%E5%9D%97%E9%93%BE%E7%BD%91%E7%BB%9C%E6%B7%BB%E5%8A%A0%E7%BB%84%E7%BB%87/" class="">区块链网络添加组织</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/2021-05-02-fabric%E6%B5%8F%E8%A7%88%E5%99%A8%E6%90%AD%E5%BB%BA/" class="">fabric浏览器搭建</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/2021-04-17-%E5%A6%82%E4%BD%95%E5%9C%A8%E5%B7%B2%E6%9C%89%E7%BB%84%E7%BB%87%E4%B8%AD%E5%A2%9E%E5%8A%A0%E8%8A%82%E7%82%B9/" class="">如何在已有组织中增加节点</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/fabric/2021-04-15-fabric1.4%E5%A4%9A%E9%80%9A%E9%81%93%E5%AE%9E%E9%AA%8C/" class="">Fabric1.4多通道实验</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b07621083aa30b12de4c0333941e479f" class="toggle"  />
    <label for="section-b07621083aa30b12de4c0333941e479f" class="flex justify-between">
      <a role="button" class="">比特币</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/%E6%AF%94%E7%89%B9%E5%B8%81/2022-02-25-%E6%AF%94%E7%89%B9%E5%B8%81%E7%9B%B8%E5%85%B3%E6%9C%BA%E5%88%B6%E4%B8%8E%E5%8E%9F%E7%90%86/" class="">比特币相关机制与原理</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ff5477999ef29208270c84e8b56b2758" class="toggle"  />
    <label for="section-ff5477999ef29208270c84e8b56b2758" class="flex justify-between">
      <a role="button" class="">IPFS</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/ipfs/2021-12-05-go-ipfs-api/" class="">go-ipfs-api</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/ipfs/2021-07-12-ipfs-webui%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B7%A5%E5%85%B7%E6%90%AD%E5%BB%BA/" class="">ipfs-webui可视化工具搭建</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/ipfs/2021-07-08-ipfs%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E4%B8%80/" class="">IPFS基本原理（一）</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/ipfs/2021-06-02-ipfs%E7%A7%81%E6%9C%89%E7%BD%91%E7%BB%9C%E6%90%AD%E5%BB%BA/" class="">IPFS私有网络搭建</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-77a0a17b06e8d04cfb0fba9952941706" class="toggle"  />
    <label for="section-77a0a17b06e8d04cfb0fba9952941706" class="flex justify-between">
      <a role="button" class="">密码学</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/%E5%AF%86%E7%A0%81%E5%AD%A6/2022-08-15-%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/" class="">区块链安全基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/%E5%AF%86%E7%A0%81%E5%AD%A6/2021-04-12-%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%8A%A0%E5%AF%86/" class="">椭圆曲线加密</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/%E5%AF%86%E7%A0%81%E5%AD%A6/2021-03-04-%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80/" class="">密码学基础</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-2e4d10b323fd668021dbd532575d8790" class="toggle"  />
    <label for="section-2e4d10b323fd668021dbd532575d8790" class="flex justify-between">
      <a role="button" class="">Docker</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/docker/docker%E5%9F%BA%E7%A1%80/" class="">Docker基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/docker/dockerfile/" class="">Dockerfile</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/docker/2021-04-30-docker%E5%B8%B8%E7%94%A8%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/" class="">docker常用知识总结</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-70383d7f28a7ae4bf840a844eb61aa16" class="toggle"  />
    <label for="section-70383d7f28a7ae4bf840a844eb61aa16" class="flex justify-between">
      <a role="button" class="">共识算法</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/%E5%85%B1%E8%AF%86%E7%AE%97%E6%B3%95/%E5%85%B1%E8%AF%86%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/" class="">共识算法基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8C%BA%E5%9D%97%E9%93%BE/%E5%85%B1%E8%AF%86%E7%AE%97%E6%B3%95/2022-03-26-raft%E5%85%B1%E8%AF%86%E7%AE%97%E6%B3%95/" class="">Raft共识算法</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-5f7b667081fbae0581cd216f66d5102f" class="toggle"  />
    <label for="section-5f7b667081fbae0581cd216f66d5102f" class="flex justify-between">
      <a role="button" class="">博客</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8D%9A%E5%AE%A2/2022-08-27-%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BAhugo/" class="">个人博客搭建Hugo</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E5%8D%9A%E5%AE%A2/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BAhexo/" class="">个人博客搭建Hexo</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="/docs/%E5%9B%BE%E4%B9%A6/" class="">图书</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="/docs/%E5%B7%A5%E5%85%B7%E5%BA%93/" class="">工具库</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="/docs/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E6%94%B6%E8%97%8F/" class="">开源项目收藏</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>











  
<ul>
  
  <li>
    <a href="https://gitee.com/chaincode"  target="_blank" rel="noopener">
        Gitee
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>手动生成ca证书搭建fabric网络</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#亲测有效">亲测有效</a></li>
        <li><a href="#1整体架构">1.整体架构</a>
          <ul>
            <li><a href="#11fabricfabric-ca安装">1.1Fabric，Fabric-Ca安装</a></li>
          </ul>
        </li>
        <li><a href="#2-ca服务器配置">2 CA服务器配置</a>
          <ul>
            <li><a href="#21启动tls-ca服务器">2.1启动TLS CA服务器</a></li>
            <li><a href="#22-tls-ca服务器注册用户">2.2 TLS CA服务器注册用户</a></li>
            <li><a href="#23配置org0的ca服务器">2.3配置Org0的CA服务器</a></li>
            <li><a href="#24配置org1的ca服务器">2.4配置Org1的CA服务器</a></li>
            <li><a href="#25配置org2的ca服务器">2.5配置Org2的CA服务器</a></li>
          </ul>
        </li>
        <li><a href="#3生成证书并配置tls">3.生成证书并配置TLS</a>
          <ul>
            <li><a href="#31-组织一节点配置">3.1 组织一节点配置</a></li>
            <li><a href="#32-组织二节点配置">3.2 组织二节点配置</a></li>
            <li><a href="#33-排序节点配置">3.3 排序节点配置</a></li>
          </ul>
        </li>
        <li><a href="#4fabric网络配置">4.Fabric网络配置</a>
          <ul>
            <li><a href="#41-configtxyaml文件配置">4.1 configtx.yaml文件配置</a></li>
            <li><a href="#42-生成创世区块和通道配置信息">4.2 生成创世区块和通道配置信息</a></li>
            <li><a href="#43-启动orderer节点">4.3 启动Orderer节点</a></li>
            <li><a href="#44-启动组织一的cli容器">4.4 启动组织一的cli容器</a></li>
            <li><a href="#45-启动组织二的cli容器">4.5 启动组织二的cli容器</a></li>
          </ul>
        </li>
        <li><a href="#5网络测试">5.网络测试</a>
          <ul>
            <li><a href="#51-创建与加入通道">5.1 创建与加入通道</a></li>
            <li><a href="#52-安装和实例化链码">5.2 安装和实例化链码</a></li>
            <li><a href="#53-调用和查询链码">5.3 调用和查询链码</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h2 id="亲测有效">
  亲测有效
  <a class="anchor" href="#%e4%ba%b2%e6%b5%8b%e6%9c%89%e6%95%88">#</a>
</h2>
<p>【摘要】 之前介绍了使用官方脚本自动化启动一个Fabric网络，并且所有的证书都是通过官方的命令行工具cryptogen直接生成网络中的所有节点的证书。在开发环境可以这么简单进行，但是生成环境下还是需要我们自定义对网络中的节点的证书进行配置。所以在本文中，将会详细介绍一个从手动生成证书一直到启动网络的整体步骤。本文只交代整体的搭建步骤。对于Fabric-Ca的讲解不在本文的范围内。</p>
<p>之前介绍了使用官方脚本自动化启动一个Fabric网络，并且所有的证书都是通过官方的命令行工具<code>cryptogen</code>直接生成网络中的所有节点的证书。在开发环境可以这么简单进行，但是生成环境下还是需要我们自定义对网络中的节点的证书进行配置。
所以在本文中，将会详细介绍一个从手动生成证书一直到启动网络的整体步骤。本文只交代整体的搭建步骤。对于Fabric-Ca的讲解不在本文的范围内，将在另一篇文章中说明。
在这里贴出<a href="https://hyperledger-fabric-ca.readthedocs.io/en/latest/operations_guide.html">官方文档</a>地址.</p>
<h2 id="1整体架构">
  1.整体架构
  <a class="anchor" href="#1%e6%95%b4%e4%bd%93%e6%9e%b6%e6%9e%84">#</a>
</h2>
<hr>
<p>架构图直接贴过来好了：
<img src="https://img2018.cnblogs.com/blog/1652302/201912/1652302-20191208170112887-1549208858.png" alt="系统架构" /></p>
<p>官方文档采用的是多机环境，这里简洁化一点，所有的操作都在<strong>一台机器</strong>上进行，至于多机环境，以后再补充好了。
介绍一下本文所采用的整体架构：</p>
<ol>
<li>三个组织
<ol>
<li>Org0 -&gt; 组织0</li>
<li>Org1 -&gt; 组织1</li>
<li>Org2 -&gt; 组织2</li>
</ol>
</li>
<li>组织中的成员
<ol>
<li>Org0 一个Orderer节点，一个Org0的Admin节点</li>
<li>Org1 两个Peer节点，一个Org1的Admin节点，一个Org1的User节点</li>
<li>Org2 两个Peer节点，一个Org2的Admin节点，一个Org2的User节点</li>
</ol>
</li>
<li>共有四台CA服务器
<ol>
<li>TLS服务器 -&gt; 为网络中所有节点颁发TLS证书，用于通信的加密</li>
<li>Org1的CA服务器 -&gt; 为组织1中所有用户颁发证书</li>
<li>Org2的Ca服务器 -&gt; 为组织2中所有用户颁发证书</li>
<li>Org0的CA服务器 -&gt; 为组织0中所有用户颁发证书</li>
</ol>
</li>
</ol>
<p>这里的四台CA服务器都是根服务器。<strong>彼此之间都是独立的存在，没有任何关系。</strong>，也就是说每一个CA服务器生成的证书在其他CA服务器都是不能用的。
介绍完之后，可以进入正题了。</p>
<h3 id="11fabricfabric-ca安装">
  1.1Fabric，Fabric-Ca安装
  <a class="anchor" href="#11fabricfabric-ca%e5%ae%89%e8%a3%85">#</a>
</h3>
<p>本文默认读者都是对Fabric有一定的了解的，所以一些安装过程这里就没有重复说明。
第一步是安装Fabric-Ca环境，可以参考<a href="https://bbs.huaweicloud.com/blogs/137298">这里</a>,这篇文章还没有写完，以后慢慢补，不过环境的安装已经有说明。
还有就是Fabric的环境安装，可以参考<a href="https://ifican.top/2019/11/23/blog/fabric/Fabric%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba/">这里</a>。</p>
<p>完成环境搭建后，我们还需要一个<code>HOME</code>文件夹，用于存放我们生成的证书文件与<code>fabric</code>配置相关的文件。
本文设置<code>HOME</code>文件夹路径为:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span>
</span></span></code></pre></div><p>请读者自行创建，一般不要用太复杂的路径,也不要用中文路径，会为之后的操作带来很多麻烦。在下文中简单称<code>HOME</code>文件夹为<strong>工作目录</strong>,<strong>除非特殊说明，一般命令的执行都是在工作目录进行</strong>。</p>
<h2 id="2-ca服务器配置">
  2 CA服务器配置
  <a class="anchor" href="#2-ca%e6%9c%8d%e5%8a%a1%e5%99%a8%e9%85%8d%e7%bd%ae">#</a>
</h2>
<hr>
<h3 id="21启动tls-ca服务器">
  2.1启动TLS CA服务器
  <a class="anchor" href="#21%e5%90%af%e5%8a%a8tls-ca%e6%9c%8d%e5%8a%a1%e5%99%a8">#</a>
</h3>
<p>前期工作准备好之后，我们开始启动第一台CA服务器。本文中使用<code>Docker</code>容器启动。
首先在工作目录创建<code>docker-compose.yaml</code>文件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">touch</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span>.<span style="color:#a6e22e">yaml</span>
</span></span></code></pre></div><p>并在文件内添加以下内容(tips:内容格式不要乱掉)：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;2&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">networks</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">services</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">container_name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">tls</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">image</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">command</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">sh</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">c</span> <span style="color:#e6db74">&#39;fabric-ca-server start -d -b tls-ca-admin:tls-ca-adminpw --port 7052&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_HOME</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/ca/tls</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_TLS_ENABLED</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_CSR_CN</span><span style="color:#f92672">=</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">tls</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_CSR_HOSTS</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0.0</span>.<span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_DEBUG</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/ca  ##重要！！！记得修改这里的路径为自己的工作目录</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">networks</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ports</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#ae81ff">7052</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7052</span>
</span></span><span style="display:flex;"><span>      
</span></span></code></pre></div><p>启动该<code>docker</code>容器：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span>.<span style="color:#a6e22e">yaml</span> <span style="color:#a6e22e">up</span> <span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">tls</span>
</span></span></code></pre></div><p>如果命令行出现以下内容则说明启动成功：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>[<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">Listening</span> <span style="color:#a6e22e">on</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7052
</span></span></span></code></pre></div><p>同时工作目录下会出现一个<code>tls</code>的文件夹。文件夹中的内容暂先不解释，留着在另一篇文章中说明。不过有一个文件需要解释一下，因为之后会用到。
在<code>$GOPATH/src/github.com/caDemo/tls/</code>路径下的<code>ca-cert.pem</code>文件。这是<code>TLS CA</code>服务器签名的根证书，目的是用来对<code>CA</code>的<code>TLS</code>证书进行验证，同时也需要持有这个证书才可以进行证书的颁发。在多机环境下，我们需要将它复制到每一台机器上，不过本文采用的是单机环境，所以省略掉了这一步。</p>
<h3 id="22-tls-ca服务器注册用户">
  2.2 TLS CA服务器注册用户
  <a class="anchor" href="#22-tls-ca%e6%9c%8d%e5%8a%a1%e5%99%a8%e6%b3%a8%e5%86%8c%e7%94%a8%e6%88%b7">#</a>
</h3>
<p>第一步是在TLS CA服务器中注册用户，经过注册的用户才拥有TLS证书，本文中由于只在各节点之间进行TLS加密通信，所以只将<code>orderer</code>和<code>peer</code>节点的身份注册到TLS服务器。
打开一个新的终端输入以下命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">设置环境变量指定根证书的路径</span>(<span style="color:#a6e22e">如果工作目录不同的话记得指定自己的工作目录</span>,<span style="color:#a6e22e">以下不再重复说明</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">设置环境变量指定CA客户端的HOME文件夹</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_HOME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admin</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">登录管理员用户用于之后的节点身份注册</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//tls-ca-admin:tls-ca-adminpw@0.0.0.0:7052
</span></span></span></code></pre></div><p>登录成功在工作目录下的<code>tls</code>文件夹下将出现一个<code>admin</code>文件夹，这里面是<code>admin</code>的相关证书文件.
并且只有登录了<code>admin</code>，才具有权限进行用户的注册,因为该用户具有CA的全部权限，相当于CA服务器的<code>root</code>用户。
接下来对各个节点进行注册。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">peer1PW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">peer</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7052
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">peer2PW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">peer</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7052
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">peer1PW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">peer</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7052
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">peer2PW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">peer</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7052
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">orderer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org0</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">ordererPW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">orderer</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7052
</span></span></span></code></pre></div><p>这里将三个组织中的节点都进行了注册。</p>
<ul>
<li>不过<code>-d</code>这个参数并没有找到相关资料</li>
<li><code>id.name</code>是指定用户的名称</li>
<li><code>--id.secert</code>是指定密码</li>
<li><code>--id.type</code>是指定用户类型，用户类型默认为<code>client</code>,主要包括<code>peer</code>,<code>app</code>,<code>user</code>,<code>orderer</code>.</li>
<li><code>-u</code>则是指定请求CA服务器的URL。</li>
</ul>
<p>这里我们为各个节点注册TLS证书，之后Fabric网络的通信则需要通过这一步骤注册过的用户的TLS证书来进行TLS加密通信。
到这里我们只是注册了各个节点的身份，还没有获取到他们的证书。证书可以通过登录获取，不过暂时不着急获取他们的TLS证书。
接下来，我们对其他几个CA服务器进行配置。</p>
<h3 id="23配置org0的ca服务器">
  2.3配置Org0的CA服务器
  <a class="anchor" href="#23%e9%85%8d%e7%bd%aeorg0%e7%9a%84ca%e6%9c%8d%e5%8a%a1%e5%99%a8">#</a>
</h3>
<p>再强调一下，本文中的几个CA服务器都是根服务器，彼此之间没有任何关系，所以上一步骤的TLS CA服务器在这一部分并没有用到。
同样，本文使用Docker容器启动CA服务器。配置文件如下，只需要添加进之前的<code>docker-compose.yaml</code>文件中就好：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>  <span style="color:#a6e22e">org0</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">container_name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">org0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">image</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">command</span><span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">/bin/bash -c &#39;fabric-ca-server start -d -b org0-admin:org0-adminpw --port 7053&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_HOME</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/ca/org0/crypto</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_TLS_ENABLED</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_CSR_CN</span><span style="color:#f92672">=</span><span style="color:#a6e22e">org0</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_CSR_HOSTS</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0.0</span>.<span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_DEBUG</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">networks</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ports</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#ae81ff">7053</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7053</span>
</span></span><span style="display:flex;"><span>      
</span></span></code></pre></div><p>添加完之后启动它：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span>.<span style="color:#a6e22e">yaml</span> <span style="color:#a6e22e">up</span> <span style="color:#a6e22e">org0</span>
</span></span></code></pre></div><p>打开另一个终端，接下来注册org0的用户：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">首先指定环境变量</span><span style="color:#960050;background-color:#1e0010">，</span><span style="color:#a6e22e">这里的TLS证书不是之前的TLS</span> <span style="color:#a6e22e">CA服务器的根证书</span><span style="color:#960050;background-color:#1e0010">，</span><span style="color:#a6e22e">而是本组织CA服务器启动时生成的TLS根证书</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定本组织的CA客户端工作目录</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_HOME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admin</span>
</span></span></code></pre></div><p>登录<code>org0</code>的CA服务器管理员身份用于注册本组织的用户：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//org0-admin:org0-adminpw@0.0.0.0:7053
</span></span></span></code></pre></div><p>在本组织中共有两个用户：<code>orderer</code>节点和<code>admin</code>用户(这里的admin和管理员是不同的。)
将他们注册到org0的CA服务器：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">orderer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org0</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">ordererpw</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">orderer</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7053
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">admin</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org0</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">org0adminpw</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">admin</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">attrs</span> <span style="color:#e6db74">&#34;hf.Registrar.Roles=client,hf.Registrar.Attributes=*,hf.Revoker=true,hf.GenCRL=true,admin=true:ecert,abac.init=true:ecert&#34;</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7053
</span></span></span></code></pre></div><p>命令执行完之后，将会注册一个Orderer节点的身份和一个Admin的身份。同时在工作目录下的<code>org0</code>子文件夹中会有两个文件夹：<code>crypto</code>和<code>admin</code>。<code>crypto</code>中是CA服务器的配置信息，<code>admin</code>是服务器管理员的身份信息。</p>
<h3 id="24配置org1的ca服务器">
  2.4配置Org1的CA服务器
  <a class="anchor" href="#24%e9%85%8d%e7%bd%aeorg1%e7%9a%84ca%e6%9c%8d%e5%8a%a1%e5%99%a8">#</a>
</h3>
<p>同样的步骤，对org1组织的CA服务器进行配置：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>  <span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">container_name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">org1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">image</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">command</span><span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">/bin/bash -c &#39;fabric-ca-server start -d -b org1-admin:org1-adminpw&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_HOME</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/ca/org1/crypto</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_TLS_ENABLED</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_CSR_CN</span><span style="color:#f92672">=</span><span style="color:#a6e22e">org1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_CSR_HOSTS</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0.0</span>.<span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_DEBUG</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">networks</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ports</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#ae81ff">7054</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7054</span>
</span></span><span style="display:flex;"><span>      
</span></span></code></pre></div><p>启动服务器：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span>.<span style="color:#a6e22e">yaml</span> <span style="color:#a6e22e">up</span> <span style="color:#a6e22e">org1</span>
</span></span></code></pre></div><p>打开新的终端，配置环境变量：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_HOME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admin</span>
</span></span></code></pre></div><p>登录CA服务器管理员身份：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//org1-admin:org1-adminpw@0.0.0.0:7054
</span></span></span></code></pre></div><p>组织一种共有四个用户：<code>peer1</code>,<code>peer2</code>,<code>admin</code>,<code>user</code>,分别注册他们：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">peer1PW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">peer</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7054
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">peer2PW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">peer</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7054
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">admin</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">org1AdminPW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7054
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">user</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">org1UserPW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7054
</span></span></span></code></pre></div><h3 id="25配置org2的ca服务器">
  2.5配置Org2的CA服务器
  <a class="anchor" href="#25%e9%85%8d%e7%bd%aeorg2%e7%9a%84ca%e6%9c%8d%e5%8a%a1%e5%99%a8">#</a>
</h3>
<p>和上一部分相同，这里只列举需要的命令：
CA服务器配置文件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>  <span style="color:#a6e22e">org2</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">container_name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">org2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">image</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">command</span><span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">/bin/bash -c &#39;fabric-ca-server start -d -b org2-admin:org2-adminpw --port 7055&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_HOME</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/ca/org2/crypto</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_TLS_ENABLED</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_CSR_CN</span><span style="color:#f92672">=</span><span style="color:#a6e22e">org2</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_CSR_HOSTS</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0.0</span>.<span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_CA_SERVER_DEBUG</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">networks</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ports</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#ae81ff">7055</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7055</span>
</span></span><span style="display:flex;"><span>      
</span></span></code></pre></div><p>启动服务器：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span>.<span style="color:#a6e22e">yaml</span> <span style="color:#a6e22e">up</span> <span style="color:#a6e22e">org2</span>
</span></span></code></pre></div><p>打开新的终端，配置环境变量：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_HOME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admin</span>
</span></span></code></pre></div><p>登录CA服务器管理员身份：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//org2-admin:org2-adminpw@0.0.0.0:7055
</span></span></span></code></pre></div><p>组织一种共有四个用户：<code>peer1</code>,<code>peer2</code>,<code>admin</code>,<code>user</code>,分别注册他们：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">peer1PW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">peer</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7055
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">peer2PW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">peer</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7055
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">admin</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">org1AdminPW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7055
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">register</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">name</span> <span style="color:#a6e22e">user</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">secret</span> <span style="color:#a6e22e">org1UserPW</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">type</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//0.0.0.0:7055
</span></span></span></code></pre></div><h2 id="3生成证书并配置tls">
  3.生成证书并配置TLS
  <a class="anchor" href="#3%e7%94%9f%e6%88%90%e8%af%81%e4%b9%a6%e5%b9%b6%e9%85%8d%e7%bd%aetls">#</a>
</h2>
<hr>
<p>到目前为止，所有的用户我们都注册完毕，接下来就是为每一个用户生成证书并配置TLS证书。
其中证书分为两部分，分别是本组织的MSP证书，以及组织之间进行加密通信的TLS证书。
所以本文需要对两部分证书进行分别生成与配置。
从组织一开始：</p>
<h3 id="31-组织一节点配置">
  3.1 组织一节点配置
  <a class="anchor" href="#31-%e7%bb%84%e7%bb%87%e4%b8%80%e8%8a%82%e7%82%b9%e9%85%8d%e7%bd%ae">#</a>
</h3>
<h4 id="311-peer1">
  3.1.1 peer1
  <a class="anchor" href="#311-peer1">#</a>
</h4>
<p>首先是本组织的<code>MSP</code>证书：</p>
<ul>
<li>配置环境变量</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定peer1节点的HOME目录</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_HOME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定</span><span style="color:#f92672">**</span><span style="color:#a6e22e">本</span><span style="color:#f92672">**</span><span style="color:#a6e22e">组织的TLS根证书</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span></code></pre></div><ul>
<li>登录<code>peer1</code>节点到<code>org1 CA</code>服务器上：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//peer1-org1:peer1PW@0.0.0.0:7054
</span></span></span></code></pre></div><p>这一步完成后，在<code>$GOPATH/src/github.com/caDemo/org1/peer1</code>下会出现一个<code>msp</code>文件夹，这是<code>peer1</code>节点的<code>MSP</code>证书。
接下来是<code>TLS</code>证书：</p>
<ul>
<li>配置环境变量</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定TLS</span> <span style="color:#a6e22e">CA服务器生成的TLS根证书</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定TLS证书的HOME目录</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_MSPDIR</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span>
</span></span></code></pre></div><ul>
<li>登录<code>peer1</code>节点到<code>TLS CA</code>服务器上：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//peer1-org1:peer1PW@0.0.0.0:7052 --enrollment.profile tls --csr.hosts peer1-org1
</span></span></span></code></pre></div><p>这一步完成后，在<code>$GOPATH/src/github.com/caDemo/org1/peer1</code>下会出现一个<code>tls-msp</code>文件夹，这是<code>peer1</code>节点的<code>TLS</code>证书。</p>
<ul>
<li>修改秘钥文件名
为什么要修改呢，进入这个文件夹看一下就知道了,由服务器生成的秘钥文件名是一长串无规则的字符串，后期我们使用的时候难道要一个字符一个字符地输入？</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">keystore</span><span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mv</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">_sk</span> <span style="color:#a6e22e">key</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">修改完回到工作目录</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span>
</span></span></code></pre></div><h4 id="312-peer2">
  3.1.2 peer2
  <a class="anchor" href="#312-peer2">#</a>
</h4>
<p><code>peer2</code>节点和上面步骤相同：
这里就直接放需要的命令了：</p>
<ul>
<li>生成<code>MSP</code>证书</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_HOME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer2</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//peer2-org1:peer2PW@0.0.0.0:7054
</span></span></span></code></pre></div><ul>
<li>生成<code>TLS</code>证书</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_MSPDIR</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//peer2-org1:peer2PW@0.0.0.0:7052 --enrollment.profile tls --csr.hosts peer2-org1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">keystore</span><span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mv</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">_sk</span> <span style="color:#a6e22e">key</span>.<span style="color:#a6e22e">pem</span>
</span></span></code></pre></div><h4 id="313-admin">
  3.1.3 admin
  <a class="anchor" href="#313-admin">#</a>
</h4>
<p>接下来是<code>admin</code>用户，这个用户有什么作用呢，实际上，安装和实例化链码都需要<code>admin</code>的证书，所以才需要注册一个<code>admin</code>用户，还要它的证书。</p>
<ul>
<li>配置环境变量</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_HOME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">adminuser</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">这里多了一个环境变量</span><span style="color:#960050;background-color:#1e0010">，</span><span style="color:#a6e22e">是指定admin用户的msp证书文件夹的</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_MSPDIR</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">adminuser</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span>
</span></span></code></pre></div><ul>
<li>登录<code>admin</code>用户获取<code>MSP</code>证书:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//admin-org1:org1AdminPW@0.0.0.0:7054
</span></span></span></code></pre></div><p>因为我们生成这个用户的证书主要就是为了之后链码的安装和实例化，所以配不配置他的<code>TLS</code>证书也无关紧要了(关键是我们之前也没有将这个用户注册到<code>tls</code>服务器中)</p>
<ul>
<li>复制证书到<code>admincerts</code>文件夹:
去看Fabric官方的例子，每一个<code>peer</code>节点的<code>MSP</code>文件夹下都有<code>admincerts</code>这个子文件夹的，而且是需要我们手动创建的。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">mkdir</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">p</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admincerts</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">将签名证书拷贝过去</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cp</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">adminuser</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">signcerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admincerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">admin</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">回到工作目录</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span>
</span></span></code></pre></div><h4 id="314-启动peer节点">
  3.1.4 启动peer节点
  <a class="anchor" href="#314-%e5%90%af%e5%8a%a8peer%e8%8a%82%e7%82%b9">#</a>
</h4>
<p>到这里，已经配置好了一个节点，所以我们就可以启动这个节点了，当然在之后和<code>orderer</code>节点一起启动也可以，不过忙活了这么多，还是应该提前看到一下所做的工作的成果的！
附上<code>peer1</code>节点的容器配置信息：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>  <span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">container_name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">image</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">peer</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_ID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_ADDRESS</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7051</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_LOCALMSPID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">org1MSP</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_MSPCONFIGPATH</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer1/msp</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_VM_ENDPOINT</span><span style="color:#f92672">=</span><span style="color:#a6e22e">unix</span><span style="color:#f92672">:</span><span style="color:#75715e">///host/var/run/docker.sock
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE</span><span style="color:#f92672">=</span><span style="color:#a6e22e">cademo_fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_LOGGING_SPEC</span><span style="color:#f92672">=</span><span style="color:#a6e22e">debug</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_ENABLED</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_CERT_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer1/tls-msp/signcerts/cert.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_KEY_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer1/tls-msp/keystore/key.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_ROOTCERT_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer1/tls-msp/tlscacerts/tls-0-0-0-0-7052.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_USELEADERELECTION</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_ORGLEADER</span><span style="color:#f92672">=</span><span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_EXTERNALENDPOINT</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7051</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_SKIPHANDSHAKE</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">working_dir</span><span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">/opt/gopath/src/github.com/hyperledger/fabric/org1/peer1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#960050;background-color:#1e0010">/var/run:/host/var/run</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">networks</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>      
</span></span></code></pre></div><p>启动它！！</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span>.<span style="color:#a6e22e">yaml</span> <span style="color:#a6e22e">up</span> <span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span>
</span></span></code></pre></div><p>如果没有报错的话，说明之前配置的没有什么问题，如果出错的话，则需要返回去检查一下了。。。
<code>peer2</code>节点的容器配置信息：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>  <span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">container_name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">image</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">peer</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_ID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_ADDRESS</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">8051</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_LOCALMSPID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">org1MSP</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_MSPCONFIGPATH</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer2/msp</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_VM_ENDPOINT</span><span style="color:#f92672">=</span><span style="color:#a6e22e">unix</span><span style="color:#f92672">:</span><span style="color:#75715e">///host/var/run/docker.sock
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE</span><span style="color:#f92672">=</span><span style="color:#a6e22e">cademo_fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_LOGGING_SPEC</span><span style="color:#f92672">=</span><span style="color:#a6e22e">debug</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_ENABLED</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_CERT_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer2/tls-msp/signcerts/cert.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_KEY_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer2/tls-msp/keystore/key.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_ROOTCERT_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer2/tls-msp/tlscacerts/tls-0-0-0-0-7052.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_USELEADERELECTION</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_ORGLEADER</span><span style="color:#f92672">=</span><span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_EXTERNALENDPOINT</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7051</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_SKIPHANDSHAKE</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">working_dir</span><span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">/opt/gopath/src/github.com/hyperledger/fabric/org1/peer2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#960050;background-color:#1e0010">/var/run:/host/var/run</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer2</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">networks</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>      
</span></span></code></pre></div><p>启动它！！</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span>.<span style="color:#a6e22e">yaml</span> <span style="color:#a6e22e">up</span> <span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span>
</span></span></code></pre></div><h3 id="32-组织二节点配置">
  3.2 组织二节点配置
  <a class="anchor" href="#32-%e7%bb%84%e7%bb%87%e4%ba%8c%e8%8a%82%e7%82%b9%e9%85%8d%e7%bd%ae">#</a>
</h3>
<p>和之前一样的步骤，所以没什么好解释的了：</p>
<h4 id="321-peer1">
  3.2.1 peer1
  <a class="anchor" href="#321-peer1">#</a>
</h4>
<ul>
<li>配置环境变量</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定peer2节点的HOME目录</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_HOME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定本组织的TLS根证书</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span></code></pre></div><ul>
<li>登录<code>peer1</code>节点到<code>org2 CA</code>服务器上：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//peer1-org2:peer1PW@0.0.0.0:7055
</span></span></span></code></pre></div><p>接下来是<code>TLS</code>证书：</p>
<ul>
<li>配置环境变量</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定TLS</span> <span style="color:#a6e22e">CA服务器生成的TLS根证书</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定TLS证书的HOME目录</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_MSPDIR</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span>
</span></span></code></pre></div><ul>
<li>登录<code>peer1</code>节点到<code>TLS CA</code>服务器上：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//peer1-org2:peer1PW@0.0.0.0:7052 --enrollment.profile tls --csr.hosts peer1-org2
</span></span></span></code></pre></div><ul>
<li>修改秘钥文件名</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">keystore</span><span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mv</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">_sk</span> <span style="color:#a6e22e">key</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">修改完回到工作目录</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span>
</span></span></code></pre></div><h4 id="322-peer2">
  3.2.2 peer2
  <a class="anchor" href="#322-peer2">#</a>
</h4>
<ul>
<li>生成<code>MSP</code>证书</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_HOME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer2</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//peer2-org2:peer2PW@0.0.0.0:7055
</span></span></span></code></pre></div><ul>
<li>生成<code>TLS</code>证书</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_MSPDIR</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//peer2-org2:peer2PW@0.0.0.0:7052 --enrollment.profile tls --csr.hosts peer2-org2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">keystore</span><span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mv</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">_sk</span> <span style="color:#a6e22e">key</span>.<span style="color:#a6e22e">pem</span>
</span></span></code></pre></div><h4 id="323-admin">
  3.2.3 admin
  <a class="anchor" href="#323-admin">#</a>
</h4>
<ul>
<li>配置环境变量</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_HOME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">adminuser</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_MSPDIR</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">adminuser</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span>
</span></span></code></pre></div><ul>
<li>登录<code>admin</code>用户获取<code>MSP</code>证书:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//admin-org2:org2AdminPW@0.0.0.0:7055
</span></span></span></code></pre></div><ul>
<li>复制证书到<code>admincerts</code>文件夹:
去看Fabric官方的例子，每一个<code>peer</code>节点的<code>MSP</code>文件夹下都有<code>admincerts</code>这个子文件夹的，而且是需要我们手动创建的。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">mkdir</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">p</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admincerts</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">将签名证书拷贝过去</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cp</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">adminuser</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">signcerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admincerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">admin</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">回到工作目录</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span>
</span></span></code></pre></div><h4 id="324-启动peer节点">
  3.2.4 启动peer节点
  <a class="anchor" href="#324-%e5%90%af%e5%8a%a8peer%e8%8a%82%e7%82%b9">#</a>
</h4>
<p>附上<code>peer1</code>节点的容器配置信息：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>  <span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">container_name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">image</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">peer</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_ID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_ADDRESS</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">9051</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_LOCALMSPID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">org2MSP</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_MSPCONFIGPATH</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer1/msp</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_VM_ENDPOINT</span><span style="color:#f92672">=</span><span style="color:#a6e22e">unix</span><span style="color:#f92672">:</span><span style="color:#75715e">///host/var/run/docker.sock
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE</span><span style="color:#f92672">=</span><span style="color:#a6e22e">cademo_fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_LOGGING_SPEC</span><span style="color:#f92672">=</span><span style="color:#a6e22e">debug</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_ENABLED</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_CERT_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer1/tls-msp/signcerts/cert.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_KEY_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer1/tls-msp/keystore/key.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_ROOTCERT_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer1/tls-msp/tlscacerts/tls-0-0-0-0-7052.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_USELEADERELECTION</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_ORGLEADER</span><span style="color:#f92672">=</span><span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_EXTERNALENDPOINT</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">9051</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_SKIPHANDSHAKE</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">working_dir</span><span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">/opt/gopath/src/github.com/hyperledger/fabric/org2/peer1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#960050;background-color:#1e0010">/var/run:/host/var/run</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">networks</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>      
</span></span></code></pre></div><p>启动它.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span>.<span style="color:#a6e22e">yaml</span> <span style="color:#a6e22e">up</span> <span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span>
</span></span></code></pre></div><p><code>peer2</code>节点的容器配置信息：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>  <span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">container_name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">image</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">peer</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_ID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_ADDRESS</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10051</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_LOCALMSPID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">org2MSP</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_MSPCONFIGPATH</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer2/msp</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_VM_ENDPOINT</span><span style="color:#f92672">=</span><span style="color:#a6e22e">unix</span><span style="color:#f92672">:</span><span style="color:#75715e">///host/var/run/docker.sock
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE</span><span style="color:#f92672">=</span><span style="color:#a6e22e">cademo_fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_LOGGING_SPEC</span><span style="color:#f92672">=</span><span style="color:#a6e22e">debug</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_ENABLED</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_CERT_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer2/tls-msp/signcerts/cert.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_KEY_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer2/tls-msp/keystore/key.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_ROOTCERT_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer2/tls-msp/tlscacerts/tls-0-0-0-0-7052.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_USELEADERELECTION</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_ORGLEADER</span><span style="color:#f92672">=</span><span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_EXTERNALENDPOINT</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">9051</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_GOSSIP_SKIPHANDSHAKE</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">working_dir</span><span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">/opt/gopath/src/github.com/hyperledger/fabric/org2/peer2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#960050;background-color:#1e0010">/var/run:/host/var/run</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer2</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">networks</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>      
</span></span></code></pre></div><p>启动它.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span>.<span style="color:#a6e22e">yaml</span> <span style="color:#a6e22e">up</span> <span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span>
</span></span></code></pre></div><h3 id="33-排序节点配置">
  3.3 排序节点配置
  <a class="anchor" href="#33-%e6%8e%92%e5%ba%8f%e8%8a%82%e7%82%b9%e9%85%8d%e7%bd%ae">#</a>
</h3>
<p>接下来是排序节点的配置，为什么放在最后面呢，因为排序节点的启动需要提前生成创世区块，而创世区块的生成涉及到另一个配置文件，所以就先配置简单的<code>peer</code>节点。</p>
<h4 id="331-orderer">
  3.3.1 orderer
  <a class="anchor" href="#331-orderer">#</a>
</h4>
<ul>
<li>配置环境变量</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定order节点的HOME目录</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_HOME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">orderer</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定本组织的TLS根证书</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span></code></pre></div><ul>
<li>登录<code>order</code>节点到<code>org0 CA</code>服务器上：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//orderer-org0:ordererpw@0.0.0.0:7053
</span></span></span></code></pre></div><p>接下来是<code>TLS</code>证书：</p>
<ul>
<li>配置环境变量</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定TLS</span> <span style="color:#a6e22e">CA服务器生成的TLS根证书</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_MSPDIR</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">orderer</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">指定TLS根证书</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span></code></pre></div><ul>
<li>登录<code>orderer</code>节点到<code>TLS CA</code>服务器上：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//orderer-org0:ordererPW@0.0.0.0:7052 --enrollment.profile tls --csr.hosts orderer-org0
</span></span></span></code></pre></div><ul>
<li>修改秘钥文件名</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">orderer</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">keystore</span><span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mv</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">_sk</span> <span style="color:#a6e22e">key</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">修改完回到工作目录</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span>
</span></span></code></pre></div><h4 id="332-admin">
  3.3.2 admin
  <a class="anchor" href="#332-admin">#</a>
</h4>
<ul>
<li>配置环境变量</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_HOME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">adminuser</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_TLS_CERTFILES</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CA_CLIENT_MSPDIR</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">adminuser</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span>
</span></span></code></pre></div><ul>
<li>登录<code>admin</code>用户获取<code>MSP</code>证书:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">enroll</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//admin-org0:org0adminpw@0.0.0.0:7053
</span></span></span></code></pre></div><ul>
<li>复制证书到<code>admincerts</code>文件夹:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">orderer</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admincerts</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">将签名证书拷贝过去</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cp</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">adminuser</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">signcerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">orderer</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admincerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">orderer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">admin</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">回到工作目录</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span>
</span></span></code></pre></div><h2 id="4fabric网络配置">
  4.Fabric网络配置
  <a class="anchor" href="#4fabric%e7%bd%91%e7%bb%9c%e9%85%8d%e7%bd%ae">#</a>
</h2>
<hr>
<p>接下来到重头戏了，证书都生成好了，即将要启动网络了。不过在启动网络之前还是有很多准备工作需要做。其实到这里，官方文档已经好多没有交代清楚的了，所以一下好多内容都是笔者自己摸索出来的，如有错误欢迎批评指正。</p>
<h3 id="41-configtxyaml文件配置">
  4.1 configtx.yaml文件配置
  <a class="anchor" href="#41-configtxyaml%e6%96%87%e4%bb%b6%e9%85%8d%e7%bd%ae">#</a>
</h3>
<p>在下一个步骤的生成创世区块和通道配置信息需要一个文件：<code>configtx.yaml</code>文件。笔者根据官方的例子按照本文内容修改了一下，直接放在工作目录:</p>
<details style="box-sizing: border-box; margin: 0px; padding: 0px; display: block;"></details>
<p>注释掉的部分是策略部分，笔者还没有完全搞懂，所以索性就先注释掉了，以后搞懂了再添加进去。
还有一部分<code>msp</code>需要配置，就是<code>configtx.yaml</code>文件中第一部分指定的<code>MSPDir</code>,很简单，按照一下命令复制一下就好了：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">进入工作目录</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">############################################</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">org0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span> <span style="color:#f92672">&amp;&amp;</span>  <span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">admincerts</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">cacerts</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">tlscacerts</span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cp</span> <span style="color:#a6e22e">adminuser</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">signcerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span> <span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admincerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cp</span> <span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span> <span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">cacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cp</span> ..<span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span> <span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tlscacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">############################################</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">org1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span>  <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">admincerts</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">cacerts</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">tlscacerts</span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cp</span> <span style="color:#a6e22e">adminuser</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">signcerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span> <span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admincerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cp</span> <span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span> <span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">cacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cp</span> ..<span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span> <span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tlscacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">############################################</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">org2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span>  <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">admincerts</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">cacerts</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">mkdir</span> <span style="color:#a6e22e">tlscacerts</span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cp</span> <span style="color:#a6e22e">adminuser</span><span style="color:#f92672">/</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">signcerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span> <span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admincerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cp</span> <span style="color:#a6e22e">crypto</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span> <span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">cacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cp</span> ..<span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span> <span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tlscacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>
</span></span></code></pre></div><h3 id="42-生成创世区块和通道配置信息">
  4.2 生成创世区块和通道配置信息
  <a class="anchor" href="#42-%e7%94%9f%e6%88%90%e5%88%9b%e4%b8%96%e5%8c%ba%e5%9d%97%e5%92%8c%e9%80%9a%e9%81%93%e9%85%8d%e7%bd%ae%e4%bf%a1%e6%81%af">#</a>
</h3>
<p>可以了，所有的前期工作都已经完成，接下来就是手动启动网络了，第一步，生成创世区块和通道配置信息：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">cd</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">FABRIC_CFG_PATH</span><span style="color:#f92672">=</span><span style="color:#a6e22e">$PWD</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">生成创世区块</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">configtxgen</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">profile</span> <span style="color:#a6e22e">TwoOrgsOrdererGenesis</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">outputBlock</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">genesis</span>.<span style="color:#a6e22e">block</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">生成通道配置信息</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">configtxgen</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">profile</span> <span style="color:#a6e22e">TwoOrgsChannel</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">outputCreateChannelTx</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">channel</span>.<span style="color:#a6e22e">tx</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">channelID</span> <span style="color:#a6e22e">mychannel</span>
</span></span></code></pre></div><h3 id="43-启动orderer节点">
  4.3 启动Orderer节点
  <a class="anchor" href="#43-%e5%90%af%e5%8a%a8orderer%e8%8a%82%e7%82%b9">#</a>
</h3>
<p><code>orderer</code>容器配置文件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>  <span style="color:#a6e22e">orderer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">container_name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">orderer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">image</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">orderer</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_HOME</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/orderer</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_HOST</span><span style="color:#f92672">=</span><span style="color:#a6e22e">orderer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org0</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_GENERAL_LISTENADDRESS</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0.0</span>.<span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_GENERAL_GENESISMETHOD</span><span style="color:#f92672">=</span><span style="color:#a6e22e">file</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_GENERAL_GENESISFILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/genesis.block</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_GENERAL_LOCALMSPID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">org0MSP</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_GENERAL_LOCALMSPDIR</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org0/orderer/msp</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_GENERAL_TLS_ENABLED</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_GENERAL_TLS_CERTIFICATE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org0/orderer/tls-msp/signcerts/cert.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_GENERAL_TLS_PRIVATEKEY</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org0/orderer/tls-msp/keystore/key.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_GENERAL_TLS_ROOTCAS</span><span style="color:#f92672">=</span>[<span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org0/orderer/tls-msp/tlscacerts/tls-0-0-0-0-7052.pem]</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_GENERAL_LOGLEVEL</span><span style="color:#f92672">=</span><span style="color:#a6e22e">debug</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">ORDERER_DEBUG_BROADCASTTRACEDIR</span><span style="color:#f92672">=</span><span style="color:#a6e22e">data</span><span style="color:#f92672">/</span><span style="color:#a6e22e">logs</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">/</span><span style="color:#a6e22e">orderer</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org0/orderer/</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">networks</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>    
</span></span></code></pre></div><p>关键部分到了，只要这一步没有出现错误，整个网络就启动成功了。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span>.<span style="color:#a6e22e">yaml</span> <span style="color:#a6e22e">up</span> <span style="color:#a6e22e">orderer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org0</span>
</span></span></code></pre></div><h3 id="44-启动组织一的cli容器">
  4.4 启动组织一的cli容器
  <a class="anchor" href="#44-%e5%90%af%e5%8a%a8%e7%bb%84%e7%bb%87%e4%b8%80%e7%9a%84cli%e5%ae%b9%e5%99%a8">#</a>
</h3>
<p><code>cli</code>容器内容,我们需要这个容器对组织1进行链码的交互：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>  <span style="color:#a6e22e">cli</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">container_name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cli</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">image</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">tools</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tty</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">stdin_open</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">SYS_CHANNEL</span><span style="color:#f92672">=</span><span style="color:#a6e22e">testchainid</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">GOPATH</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/opt/gopath</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_VM_ENDPOINT</span><span style="color:#f92672">=</span><span style="color:#a6e22e">unix</span><span style="color:#f92672">:</span><span style="color:#75715e">///host/var/run/docker.sock
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_LOGGING_SPEC</span><span style="color:#f92672">=</span><span style="color:#a6e22e">DEBUG</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_ID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">cli</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_ADDRESS</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7051</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_LOCALMSPID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">org1MSP</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_ENABLED</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_ROOTCERT_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer1/tls-msp/tlscacerts/tls-0-0-0-0-7052.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_CERT_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer1/tls-msp/signcerts/cert.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_KEY_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer1/tls-msp/keystore/key.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_MSPCONFIGPATH</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer1/msp</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">working_dir</span><span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">/opt/gopath/src/github.com/hyperledger/fabric/org1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">command</span><span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">/bin/bash</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/peer1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">assets</span><span style="color:#f92672">/</span><span style="color:#a6e22e">chaincode</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/opt/gopath/src/github.com/hyperledger/fabric-samples/chaincode</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">adminuser</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/adminuser</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">networks</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">depends_on</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span>
</span></span></code></pre></div><p>启动该容器：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span>.<span style="color:#a6e22e">yaml</span> <span style="color:#a6e22e">up</span> <span style="color:#a6e22e">cli</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span>
</span></span></code></pre></div><h3 id="45-启动组织二的cli容器">
  4.5 启动组织二的cli容器
  <a class="anchor" href="#45-%e5%90%af%e5%8a%a8%e7%bb%84%e7%bb%87%e4%ba%8c%e7%9a%84cli%e5%ae%b9%e5%99%a8">#</a>
</h3>
<p><code>cli</code>容器内容,我们需要这个容器对组织2进行链码的交互：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>  <span style="color:#a6e22e">cli</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">container_name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cli</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">image</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">tools</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tty</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">stdin_open</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">SYS_CHANNEL</span><span style="color:#f92672">=</span><span style="color:#a6e22e">testchainid</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">GOPATH</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/opt/gopath</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_VM_ENDPOINT</span><span style="color:#f92672">=</span><span style="color:#a6e22e">unix</span><span style="color:#f92672">:</span><span style="color:#75715e">///host/var/run/docker.sock
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">FABRIC_LOGGING_SPEC</span><span style="color:#f92672">=</span><span style="color:#a6e22e">DEBUG</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_ID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">cli</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_ADDRESS</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">9051</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_LOCALMSPID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">org2MSP</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_ENABLED</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_ROOTCERT_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer1/tls-msp/tlscacerts/tls-0-0-0-0-7052.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_CERT_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer1/tls-msp/signcerts/cert.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_TLS_KEY_FILE</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer1/tls-msp/keystore/key.pem</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_PEER_MSPCONFIGPATH</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer1/msp</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">working_dir</span><span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">/opt/gopath/src/github.com/hyperledger/fabric/org2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">command</span><span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">/bin/bash</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/peer1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">assets</span><span style="color:#f92672">/</span><span style="color:#a6e22e">chaincode</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/opt/gopath/src/github.com/hyperledger/fabric-samples/chaincode</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">adminuser</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org2/adminuser</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">$GOPATH</span><span style="color:#f92672">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">/</span><span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">caDemo</span><span style="color:#f92672">:</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">networks</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">depends_on</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span>
</span></span></code></pre></div><p>启动该容器：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">compose</span>.<span style="color:#a6e22e">yaml</span> <span style="color:#a6e22e">up</span> <span style="color:#a6e22e">cli</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org2</span>
</span></span></code></pre></div><h2 id="5网络测试">
  5.网络测试
  <a class="anchor" href="#5%e7%bd%91%e7%bb%9c%e6%b5%8b%e8%af%95">#</a>
</h2>
<hr>
<p>所有工作准备完成，接下来让我们测试整个网络能不能正常运行吧：</p>
<h3 id="51-创建与加入通道">
  5.1 创建与加入通道
  <a class="anchor" href="#51-%e5%88%9b%e5%bb%ba%e4%b8%8e%e5%8a%a0%e5%85%a5%e9%80%9a%e9%81%93">#</a>
</h3>
<p>以<strong>组织1</strong>为例：</p>
<ul>
<li>首先进入<code>cli</code>容器：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span> <span style="color:#a6e22e">exec</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">it</span> <span style="color:#a6e22e">cli</span> <span style="color:#a6e22e">bash</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">配置环境变量</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">CORE_PEER_MSPCONFIGPATH</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/adminuser/msp</span>
</span></span></code></pre></div><ul>
<li>创建通道</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">peer</span> <span style="color:#a6e22e">channel</span> <span style="color:#a6e22e">create</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">c</span> <span style="color:#a6e22e">mychannel</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">tmp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">channel</span>.<span style="color:#a6e22e">tx</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">o</span> <span style="color:#a6e22e">orderer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7050</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">outputBlock</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">tmp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">mychannel</span>.<span style="color:#a6e22e">block</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">tls</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">cafile</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">tmp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tlscacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">7052.</span><span style="color:#a6e22e">pem</span>
</span></span></code></pre></div><ul>
<li>将<code>peer1-org1</code>加入通道：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">CORE_PEER_ADDRESS</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7051</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">peer</span> <span style="color:#a6e22e">channel</span> <span style="color:#a6e22e">join</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">b</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">tmp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">mychannel</span>.<span style="color:#a6e22e">block</span>
</span></span></code></pre></div><ul>
<li>将<code>peer2-org1</code>加入通道：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">CORE_PEER_ADDRESS</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">8051</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">peer</span> <span style="color:#a6e22e">channel</span> <span style="color:#a6e22e">join</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">b</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">tmp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">mychannel</span>.<span style="color:#a6e22e">block</span>
</span></span></code></pre></div><p>组织二步骤是相同的，唯一不同的就是不需要创建通道了，所以就不再说明了。</p>
<h3 id="52-安装和实例化链码">
  5.2 安装和实例化链码
  <a class="anchor" href="#52-%e5%ae%89%e8%a3%85%e5%92%8c%e5%ae%9e%e4%be%8b%e5%8c%96%e9%93%be%e7%a0%81">#</a>
</h3>
<p>以<strong>组织1</strong>为例：</p>
<ul>
<li>首先进入<code>cli</code>容器：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span> <span style="color:#a6e22e">exec</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">it</span> <span style="color:#a6e22e">cli</span> <span style="color:#a6e22e">bash</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">配置环境变量</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">CORE_PEER_MSPCONFIGPATH</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/adminuser/msp</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">CORE_PEER_ADDRESS</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7051</span>
</span></span></code></pre></div><ul>
<li>安装链码
<strong>记得提前将链码放到</strong><code>$GOPATH/src/github.com/caDemo/org1/peer1/assets/chaincode</code><strong>路径下。</strong>,本文使用的是<code>fabric-samples/chaincode/chaincode_example02</code>官方示例链码。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">peer</span> <span style="color:#a6e22e">chaincode</span> <span style="color:#a6e22e">install</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">n</span> <span style="color:#a6e22e">mycc</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">v</span> <span style="color:#ae81ff">1.0</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">p</span> <span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">samples</span><span style="color:#f92672">/</span><span style="color:#a6e22e">chaincode</span><span style="color:#f92672">/</span><span style="color:#a6e22e">chaincode_example02</span><span style="color:#f92672">/</span><span style="color:#a6e22e">go</span><span style="color:#f92672">/</span>
</span></span></code></pre></div><ul>
<li>实例化链码</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">peer</span> <span style="color:#a6e22e">chaincode</span> <span style="color:#a6e22e">instantiate</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">C</span> <span style="color:#a6e22e">mychannel</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">n</span> <span style="color:#a6e22e">mycc</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">v</span> <span style="color:#ae81ff">1.0</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">c</span> <span style="color:#e6db74">&#39;{&#34;Args&#34;:[&#34;init&#34;,&#34;a&#34;,&#34;100&#34;,&#34;b&#34;,&#34;200&#34;]}&#39;</span>  <span style="color:#f92672">-</span><span style="color:#a6e22e">o</span> <span style="color:#a6e22e">orderer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org0</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7050</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">tls</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">cafile</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">tmp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tlscacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">7052.</span><span style="color:#a6e22e">pem</span>
</span></span></code></pre></div><ul>
<li>这一步在高版本的Fabric网络是会出错的，因为少了一个文件<code>config.yaml</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">NodeOUs</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Enable</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ClientOUIdentifier</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Certificate</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span>.<span style="color:#a6e22e">example</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>  <span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">这里需要修改</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">OrganizationalUnitIdentifier</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">client</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">PeerOUIdentifier</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Certificate</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span>.<span style="color:#a6e22e">example</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>  <span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">这里需要修改</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">OrganizationalUnitIdentifier</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">peer</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">AdminOUIdentifier</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Certificate</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span>.<span style="color:#a6e22e">example</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>  <span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">这里需要修改</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">OrganizationalUnitIdentifier</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">admin</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">OrdererOUIdentifier</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Certificate</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">ca</span>.<span style="color:#a6e22e">example</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cert</span>.<span style="color:#a6e22e">pem</span>  <span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">这里需要修改</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">OrganizationalUnitIdentifier</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">orderer</span>
</span></span></code></pre></div><p>因为高版本的Fabric把节点类型区分开了，所以需要我们手动配置。
将该文件复制到<code>$GOPATH/src/github.com/caDemo/org1/adminuser/msp</code>文件夹内，同时修改上面指定的位置的文件名(与对应文件夹内的文件名对应就好了)。</p>
<ul>
<li>实例化部分出错的可能性是最高的，很多都是因为网络模式指定错误导致链码容器启动失败，解决方案：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">终端执行命令</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">docker</span> <span style="color:#a6e22e">network</span> <span style="color:#a6e22e">ls</span>
</span></span></code></pre></div><p>找到以<code>fabric-ca</code>为后缀的一条如<code>cademo_fabric-ca</code>,修改之前的所有<code>peer</code>节点容器配置文件的环境变量：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">-</span> <span style="color:#a6e22e">CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE</span><span style="color:#f92672">=</span><span style="color:#a6e22e">cademo_fabric</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ca</span>
</span></span></code></pre></div><p>修改完成重启节点容器，再次执行以上的命令(需要重新配置环境变量，加入通道这两个操作)。
终于，实例化成功了。</p>
<h3 id="53-调用和查询链码">
  5.3 调用和查询链码
  <a class="anchor" href="#53-%e8%b0%83%e7%94%a8%e5%92%8c%e6%9f%a5%e8%af%a2%e9%93%be%e7%a0%81">#</a>
</h3>
<p>最后测试一下链码功能能不能正常使用了：</p>
<ul>
<li>还是组织一的<code>cli</code>容器：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">docker</span> <span style="color:#a6e22e">exec</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">it</span> <span style="color:#a6e22e">cli</span> <span style="color:#a6e22e">bash</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">CORE_PEER_MSPCONFIGPATH</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/tmp/hyperledger/org1/adminuser/msp</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#a6e22e">CORE_PEER_ADDRESS</span><span style="color:#f92672">=</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">-</span><span style="color:#a6e22e">org1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7051</span>
</span></span></code></pre></div><ul>
<li>执行查询功能：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">peer</span> <span style="color:#a6e22e">chaincode</span> <span style="color:#a6e22e">query</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">C</span> <span style="color:#a6e22e">mychannel</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">n</span> <span style="color:#a6e22e">mycc</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">c</span> <span style="color:#e6db74">&#39;{&#34;Args&#34;:[&#34;query&#34;,&#34;a&#34;]}&#39;</span>
</span></span></code></pre></div><p>命令行应该打印出:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#ae81ff">100</span>
</span></span></code></pre></div><ul>
<li>执行调用功能：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">peer</span> <span style="color:#a6e22e">chaincode</span> <span style="color:#a6e22e">invoke</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">C</span> <span style="color:#a6e22e">mychannel</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">n</span> <span style="color:#a6e22e">mycc</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">c</span> <span style="color:#e6db74">&#39;{&#34;Args&#34;:[&#34;invoke&#34;,&#34;a&#34;,&#34;b&#34;,&#34;10&#34;]}&#39;</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">tls</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">cafile</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">tmp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">hyperledger</span><span style="color:#f92672">/</span><span style="color:#a6e22e">org2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">peer1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#a6e22e">msp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tlscacerts</span><span style="color:#f92672">/</span><span style="color:#a6e22e">tls</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">7052.</span><span style="color:#a6e22e">pem</span>
</span></span></code></pre></div><ul>
<li>再次查询：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">peer</span> <span style="color:#a6e22e">chaincode</span> <span style="color:#a6e22e">query</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">C</span> <span style="color:#a6e22e">mychannel</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">n</span> <span style="color:#a6e22e">mycc</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">c</span> <span style="color:#e6db74">&#39;{&#34;Args&#34;:[&#34;query&#34;,&#34;a&#34;]}&#39;</span>
</span></span></code></pre></div><p>命令行应该打印出:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#ae81ff">90</span>
</span></span></code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#亲测有效">亲测有效</a></li>
        <li><a href="#1整体架构">1.整体架构</a>
          <ul>
            <li><a href="#11fabricfabric-ca安装">1.1Fabric，Fabric-Ca安装</a></li>
          </ul>
        </li>
        <li><a href="#2-ca服务器配置">2 CA服务器配置</a>
          <ul>
            <li><a href="#21启动tls-ca服务器">2.1启动TLS CA服务器</a></li>
            <li><a href="#22-tls-ca服务器注册用户">2.2 TLS CA服务器注册用户</a></li>
            <li><a href="#23配置org0的ca服务器">2.3配置Org0的CA服务器</a></li>
            <li><a href="#24配置org1的ca服务器">2.4配置Org1的CA服务器</a></li>
            <li><a href="#25配置org2的ca服务器">2.5配置Org2的CA服务器</a></li>
          </ul>
        </li>
        <li><a href="#3生成证书并配置tls">3.生成证书并配置TLS</a>
          <ul>
            <li><a href="#31-组织一节点配置">3.1 组织一节点配置</a></li>
            <li><a href="#32-组织二节点配置">3.2 组织二节点配置</a></li>
            <li><a href="#33-排序节点配置">3.3 排序节点配置</a></li>
          </ul>
        </li>
        <li><a href="#4fabric网络配置">4.Fabric网络配置</a>
          <ul>
            <li><a href="#41-configtxyaml文件配置">4.1 configtx.yaml文件配置</a></li>
            <li><a href="#42-生成创世区块和通道配置信息">4.2 生成创世区块和通道配置信息</a></li>
            <li><a href="#43-启动orderer节点">4.3 启动Orderer节点</a></li>
            <li><a href="#44-启动组织一的cli容器">4.4 启动组织一的cli容器</a></li>
            <li><a href="#45-启动组织二的cli容器">4.5 启动组织二的cli容器</a></li>
          </ul>
        </li>
        <li><a href="#5网络测试">5.网络测试</a>
          <ul>
            <li><a href="#51-创建与加入通道">5.1 创建与加入通道</a></li>
            <li><a href="#52-安装和实例化链码">5.2 安装和实例化链码</a></li>
            <li><a href="#53-调用和查询链码">5.3 调用和查询链码</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












